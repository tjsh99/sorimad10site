<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>소리MAD 대상</title>
    <link rel="stylesheet" href="style.css">

    <style>
        /* 1. 가로 사이즈 확장 */
        #legacy-code-area {
            width: 100%;
            max-width: 100%;
            /* 기존 800px 제한 해제 -> 메뉴바랑 똑같이 넓어짐 */
            margin: 0 auto;
            text-align: left;
        }

        .toggle-section {
            margin-bottom: 10px;
            /* 섹션 간 간격도 줄임 */
        }

        /* 2. 참가자 이름 칸(헤더) 높이 축소 */
        .toggle-header {
            background-color: #333;
            color: #fff;
            padding: 10px 15px;
            /* 위아래 패딩 15px -> 10px로 축소 */
            cursor: pointer;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .toggle-header:hover {
            background-color: #444;
        }

        .video-scroll-container {
            max-height: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            gap: 5px;
            /* 3. 카드 사이 간격 15px -> 5px로 대폭 축소 (촘촘하게) */
            padding: 0 5px;
            transition: max-height 0.5s ease-out, padding 0.5s ease-out;
        }

        .toggle-section.open .video-scroll-container {
            max-height: 2000px;
            /* 넉넉하게 */
            padding: 10px 5px;
            /* 펼쳤을 때 여백 */
        }

        /* 3. 비디오 카드 콤팩트하게 수정 */
        .video-card {
            display: flex;
            align-items: center;
            /* 위쪽 정렬 대신 중앙 정렬로 변경해서 더 안정감 있게 */
            background-color: #fff;
            border: 1px solid #eee;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s;
            width: 100%;
            box-sizing: border-box;

            padding: 8px;
            /* 카드 안쪽 여백 15px -> 8px로 축소 */
            text-align: left;
        }

        .video-card:hover {
            transform: translateX(5px);
            /* 위로 뜨는 대신 오른쪽으로 살짝 이동 */
            background-color: #f9f9f9;
        }

        .video-thumbnail {
            width: 120px;
            /* 썸네일 너비 160px -> 120px로 축소 */
            height: 68px;
            /* 비율 맞춰서 높이 자동 조절 (16:9) */
            object-fit: cover;
            border-radius: 4px;
            margin-right: 15px;
            flex-shrink: 0;
            background-color: #000;
        }

        .video-info {
            display: flex;
            flex-direction: column;
            justify-content: center;
            flex: 1;
            overflow: hidden;
            /* 글자 넘치면 숨김 */
        }

        .video-title {
            font-size: 1rem;
            /* 제목 크기 살짝 줄임 */
            font-weight: bold;
            color: #222;
            margin-bottom: 4px;
            /* 제목과 코멘트 사이 간격 좁힘 */

            /* 제목이 너무 길면 ...으로 표시 (깔끔함 유지) */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .video-comment {
            font-size: 0.9rem;
            /* 코멘트 크기 조절 */
            color: #666;
            line-height: 1.3;

            /* 코멘트도 최대 2줄까지만 표시하고 넘치면 ... 처리 (선택사항) */
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* 스크롤바 디자인 */
        .video-scroll-container::-webkit-scrollbar {
            width: 6px;
        }

        .video-scroll-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .video-scroll-container::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 4px;
        }
    </style>
</head>

<body>

    <div class="container">
        <header>
            <h1 class="main-title">
                <a href="index.html">소리MAD 대상</a>
            </h1>

            <nav class="gnb">
                <ul>
                    <li><a href="result_2025.html" class="active">소리MAD 10선</a></li>
                    <li><a href="awards_2025.html">소리MAD 어워즈</a></li>
                    <li><a href="vote.html">투표하기</a></li>
                    <li><a href="article.html">10선 기사</a></li>
                </ul>
            </nav>
        </header>

        <nav class="sub-gnb">
            <ul>
                <li><a href="result_2025.html">10선 결과</a></li>
                <li><a href="everyone_2025.html" class="sub-active">모두의 10선</a></li>
                <li><a href="comment_2025.html">코멘트</a></li>
            </ul>
        </nav>

        <main class="content-area">

            <div class="year-selector">
                <a href="everyone_2025.html" class="year-btn">2025</a>
                <a href="everyone_2024.html" class="year-btn year-active">2024</a>
            </div>

            <div id="legacy-code-area">
                <div id="container"></div>
            </div>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const sheetId = '1DZET9hl7eVakqGtGuztbGfE6cjWtO0r5Nm3QA_XFjEg';
            const sheetName = '2024';
            const baseUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?`;
            const query = encodeURIComponent(`Select B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z, AA, AB, AC, AD, AE, AF`);
            const url = `${baseUrl}&sheet=${sheetName}&tq=${query}`;

            fetch(url)
                .then(res => res.text())
                .then(rep => {
                    const data = JSON.parse(rep.substr(47).slice(0, -2));
                    const container = document.getElementById('container');

                    data.table.rows.forEach((row, index) => {
                        if (index === 0) return;
                        const title = row.c[0]?.v;

                        if (title) {
                            const section = document.createElement('div');
                            section.className = 'toggle-section';

                            const header = document.createElement('div');
                            header.className = 'toggle-header';
                            header.textContent = title;
                            header.onclick = () => toggleSection(section);

                            const scrollContainer = document.createElement('div');
                            scrollContainer.className = 'video-scroll-container';

                            for (let i = 1; i < row.c.length; i += 3) {
                                const videoId = row.c[i]?.v;
                                const videoTitle = row.c[i + 1]?.v;
                                const videoComment = row.c[i + 2]?.v;

                                if (videoId && videoTitle) {
                                    const card = createVideoCard(videoId, videoTitle, videoComment);
                                    scrollContainer.appendChild(card);
                                }
                            }

                            section.appendChild(header);
                            section.appendChild(scrollContainer);
                            container.appendChild(section);
                        }
                    });
                });

            function createVideoCard(videoId, videoTitle, videoComment) {
                const card = document.createElement('div');
                card.className = 'video-card';

                const thumbnail = document.createElement('img');
                thumbnail.src = `https://img.youtube.com/vi/${videoId}/mqdefault.jpg`;
                thumbnail.className = 'video-thumbnail';

                const info = document.createElement('div');
                info.className = 'video-info';

                const title = document.createElement('div');
                title.className = 'video-title';
                title.textContent = videoTitle;

                const comment = document.createElement('div');
                comment.className = 'video-comment';
                comment.textContent = videoComment || '';

                info.appendChild(title);
                info.appendChild(comment);
                card.appendChild(thumbnail);
                card.appendChild(info);

                card.onclick = () => window.open(`https://youtu.be/${videoId}`, '_blank');
                return card;
            }

            function toggleSection(section) {
                // 하나만 열리게 하기 (기존 로직 유지)
                document.querySelectorAll('.toggle-section').forEach(sec => {
                    if (sec !== section) {
                        sec.classList.remove('open');
                        const scrollContainer = sec.querySelector('.video-scroll-container');
                        scrollContainer.style.maxHeight = '0';
                    }
                });

                section.classList.toggle('open');
                const scrollContainer = section.querySelector('.video-scroll-container');
                if (section.classList.contains('open')) {
                    scrollContainer.style.maxHeight = `${scrollContainer.scrollHeight}px`;
                } else {
                    scrollContainer.style.maxHeight = '0';
                }
            }
        });
    </script>

</body>

</html>